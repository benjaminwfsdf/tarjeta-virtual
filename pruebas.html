<!DOCTYPE html>
<html lang="es">
<head>
  <link rel="manifest" href="manifest.json">

  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="Taller">
  <link rel="apple-touch-icon" href="icons/icon-192.png">

  <meta name="theme-color" content="#000000">
  <link rel="icon" type="image/png" href="icons/icon-192.png">

  <script>
    if ("serviceWorker" in navigator) {
      window.addEventListener("load", () => {
        navigator.serviceWorker.register("service-worker.js");
      });
    }
  </script>

  <title>Panel Principal</title>
  <style>
    :root{
      --brand:#900000;
      --brand-900:#700000;
      --ink:#e9ecef;
      --muted:#b9c0c7;
      --bg:#0b0b0c;
      --panel:#0f0f11;
      --card:#16181b;
      --card-border:#272a2f;
      --shadow:0 10px 28px rgba(0,0,0,.45);
      --shadow-hover:0 14px 40px rgba(0,0,0,.6);
      --radius:16px;
    }

    @media (prefers-reduced-motion: reduce){
      *{animation:none!important;transition:none!important}
    }

    html,body{height:100%}
    body{
      margin:0;
      font-family: system-ui,-apple-system,"Segoe UI",Roboto,Inter,Arial,sans-serif;
      background: var(--bg);
      color: var(--ink);
      -webkit-font-smoothing: antialiased;
      line-height: 1.55;
      overflow-x: hidden;
    }

    /* === SPLASH (ahora visible por defecto; se apaga por JS temprano) === */
    #splash{
      position: fixed;
      inset: 0;
      background: #000;
      display: flex;              /* 👈 visible por defecto */
      flex-direction: column;
      justify-content: center;
      align-items: center;
      z-index: 9999;
      transition: opacity .4s ease;
      text-align:center;
      padding: 24px;
      opacity: 1;
    }
    #splash img{
      width:160px;
      height:auto;
      margin-bottom:14px;
      image-rendering: -webkit-optimize-contrast;
      image-rendering: crisp-edges;
      filter: drop-shadow(0 8px 22px rgba(144,0,0,.35));
      animation: glow 1.2s ease-in-out infinite alternate, float 3s ease-in-out infinite;
    }
    #splash .brand{
      color:#fff;
      font-size: clamp(18px, 4vw, 26px);
      font-weight: 900;
      letter-spacing:.6px;
      line-height:1.15;
      margin: 2px 0 6px;
    }
    #splash .tagline{
      color:#c9ced6;
      font-size:14px;
      letter-spacing:.3px;
      opacity:.9;
    }
    #splash .bar{
      width: 180px; height: 4px;
      margin-top: 16px;
      background: #1d1d1f;
      border-radius: 999px;
      overflow: hidden;
      position: relative;
    }
    #splash .bar::after{
      content:"";
      position:absolute; inset:0;
      width:40%;
      background: linear-gradient(90deg, var(--brand-900), var(--brand));
      border-radius:999px;
      animation: slide 1.0s ease-in-out infinite;
    }
    @keyframes glow{
      from{ filter: drop-shadow(0 6px 16px rgba(144,0,0,.25)); }
      to  { filter: drop-shadow(0 12px 28px rgba(144,0,0,.45)); }
    }
    @keyframes slide{
      0%{transform: translateX(-60%);}
      50%{transform: translateX(40%);}
      100%{transform: translateX(160%);}
    }
    @keyframes float {
      0%, 100% { transform: translateY(0px); }
      50% { transform: translateY(-10px); }
    }

    /* Barra superior */
    .topbar{
      background:#000;
      color:#fff;
      text-align:center;
      padding:14px 10px;
      font-weight:700;
      letter-spacing:.6px;
      border-bottom:4px solid var(--brand);
      box-shadow: 0 6px 16px rgba(0,0,0,.55);
    }

    .wrapper{
      max-width: 1100px;
      margin: 28px auto 44px;
      padding: 0 16px;
      opacity: 0;                 /* 👈 oculto por defecto; lo muestra JS */
      transition: opacity .4s ease;
    }
    .frame{
      border: 3px solid var(--brand);
      border-radius: var(--radius);
      padding: 20px;
      background: var(--panel);
      box-shadow: var(--shadow);
    }

    .header{
      margin: 10px;
      background: linear-gradient(135deg, var(--brand), var(--brand-900));
      color:#fff;
      border-radius: 18px;
      padding: 20px 24px;
      text-align:center;
      box-shadow: 0 10px 22px rgba(179,0,0,.35);
      position: relative;
      overflow: hidden;
    }
    .header::before {
      content: "";
      position: absolute;
      top: -50%;
      left: -50%;
      width: 200%;
      height: 200%;
      background: radial-gradient(circle, rgba(255,255,255,0.1) 1%, transparent 1%);
      background-size: 20px 20px;
      opacity: 0.1;
      animation: moveBackground 20s linear infinite;
    }
    .header h1{
      margin:0;
      font-size: clamp(20px, 3.2vw, 28px);
      letter-spacing:.5px;
      position: relative;
      z-index: 1;
    }
    @keyframes moveBackground {
      0% { transform: translate(0, 0); }
      100% { transform: translate(20px, 20px); }
    }

    .grid{
      display:grid;
      grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
      gap: 24px;
      padding: 16px;
      perspective: 1000px;
    }
    @media (max-width: 768px){
      .grid{
        grid-template-columns: 1fr;
        gap: 16px;
        padding: 8px;
      }
    }

    /* Efecto de entrada en cascada para las tarjetas */
    .card {
      opacity: 0;
      transform: translateY(20px);
      animation: cardEntrance 0.6s ease forwards;
    }
    .card:nth-child(1) { animation-delay: 0.1s; }
    .card:nth-child(2) { animation-delay: 0.2s; }
    .card:nth-child(3) { animation-delay: 0.3s; }
    .card:nth-child(4) { animation-delay: 0.4s; }
    .card:nth-child(5) { animation-delay: 0.5s; }
    .card:nth-child(6) { animation-delay: 0.6s; }
    .card:nth-child(7) { animation-delay: 0.7s; }
    .card:nth-child(8) { animation-delay: 0.8s; }

    @keyframes cardEntrance {
      from {
        opacity: 0;
        transform: translateY(20px) rotateX(10deg);
      }
      to {
        opacity: 1;
        transform: translateY(0) rotateX(0);
      }
    }

    /* Estilos base de tarjeta con efecto flip */
    .card{
      position: relative;
      background: var(--card);
      border:1px solid var(--card-border);
      border-radius: 14px;
      box-shadow: 0 6px 18px rgba(0,0,0,.35);
      padding: 0;
      isolation:isolate;
      transition: box-shadow .3s ease, transform .3s ease, border-color .3s ease, background .3s ease;
      cursor: pointer;
      height: 140px;
      overflow: hidden;
    }
    
    /* Contenedor para el efecto flip */
    .card-inner {
      position: relative;
      width: 100%;
      height: 100%;
      transition: transform 0.6s;
      transform-style: preserve-3d;
    }
    
    .card.flipped .card-inner {
      transform: rotateY(180deg);
    }
    
    /* Lados de la tarjeta */
    .card-front, .card-back {
      position: absolute;
      width: 100%;
      height: 100%;
      backface-visibility: hidden;
      display: flex;
      gap: 16px;
      align-items: flex-start;
      padding: 18px 18px 16px 18px;
      box-sizing: border-box;
    }
    
    .card-back {
      transform: rotateY(180deg);
      flex-direction: column;
      justify-content: space-between;
    }
    
    /* Barra lateral roja */
    .card::before{
      content:"";
      position:absolute;
      inset:0 auto 0 0;
      width:8px;
      border-radius: 14px 0 0 14px;
      background: var(--brand);
      z-index: 2;
    }
    
    /* Efecto holograma al hacer hover */
    .card::after {
      content: "";
      position: absolute;
      top: -2px;
      left: -2px;
      right: -2px;
      bottom: -2px;
      background: linear-gradient(45deg, 
        transparent, 
        rgba(144, 0, 0, 0.2), 
        transparent, 
        rgba(144, 0, 0, 0.1), 
        transparent
      );
      z-index: -1;
      border-radius: 16px;
      opacity: 0;
      transition: opacity 0.3s ease;
    }
    
    .card:hover::after {
      opacity: 1;
      animation: hologram 2s linear infinite;
    }
    
    @keyframes hologram {
      0% { background-position: 0% 0%; }
      100% { background-position: 200% 200%; }
    }
    
    .card:hover{
      box-shadow: var(--shadow-hover);
      transform: translateY(-5px);
      border-color:#32363d;
      background:#191c20;
    }

    .icon{
      flex:0 0 44px;
      height:44px;
      border-radius: 12px;
      display:grid;
      place-items:center;
      background: linear-gradient(135deg, #1a1a1a, #0c0c0e);
      border:2px solid var(--brand);
      color:#fff;
      font-size:20px;
      margin-left: 6px;
      box-shadow: 0 4px 12px rgba(144, 0, 0, 0.25);
      transition: all 0.3s ease;
      z-index: 1;
    }
    
    .card:hover .icon {
      box-shadow: 0 0 20px rgba(144, 0, 0, 0.4);
      transform: scale(1.05);
    }

    .content{ 
      flex:1 1 auto; 
      min-width:0; 
    }
    .title{
      margin:0 0 6px;
      font-size: clamp(16px, 2.2vw, 18px);
      font-weight:800;
      letter-spacing:.2px;
      color:#f5f7fa;
    }
    .desc{ 
      margin:0; 
      color: var(--muted); 
      font-size:14.5px; 
      line-height: 1.4;
    }

    .actions{ 
      display:flex; 
      align-items:center; 
      gap:10px; 
      margin-left:auto; 
      z-index: 1;
    }
    .btn{
      appearance:none;
      border:0;
      border-radius: 12px;
      padding:10px 16px;
      font-weight:700;
      cursor:pointer;
      transition: transform .12s ease, box-shadow .2s ease, background .2s ease, color .2s ease, border-color .2s ease;
      text-decoration:none;
      display:inline-block;
      color:#fff;
      background: linear-gradient(135deg, var(--brand-900), var(--brand));
      border: 2px solid transparent;
      box-shadow: 0 4px 12px rgba(144, 0, 0, 0.3);
      letter-spacing: 0.3px;
      min-width: 80px;
      text-align: center;
    }
    .btn:hover{
      background: linear-gradient(135deg, var(--brand), #a80000);
      transform: translateY(-2px);
      box-shadow: 0 6px 16px rgba(144, 0, 0, 0.4);
    }
    .btn:active{ transform: translateY(1px); }
    .btn:focus-visible{
      outline: 3px solid rgba(144, 0, 0, 0.5);
      outline-offset: 2px;
    }

    /* Estilos para el dorso de la tarjeta */
    .stats {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
      margin-top: 10px;
      width: 100%;
    }
    
    .stat {
      text-align: center;
      padding: 8px;
      background: rgba(144, 0, 0, 0.1);
      border-radius: 8px;
      border: 1px solid rgba(144, 0, 0, 0.2);
    }
    
    .stat-value {
      font-size: 18px;
      font-weight: 800;
      color: var(--brand);
    }
    
    .stat-label {
      font-size: 11px;
      color: var(--muted);
      margin-top: 4px;
    }
    
    .back-desc {
      font-size: 13px;
      color: var(--muted);
      margin-top: 8px;
      line-height: 1.4;
    }
    
    .flip-hint {
      position: absolute;
      bottom: 10px;
      right: 15px;
      font-size: 11px;
      color: var(--muted);
      opacity: 0.7;
    }

    .footer{
      text-align:center;
      color:#8c96a3;
      font-size:12px;
      margin: 20px 0 32px;
    }
    .footer strong{ color:#cfd6de; }
  </style>

  <!-- Decisión temprana: ¿mostrar splash o no? (evita parpadeo) -->
  <script>
    (function(){
      const nav = (performance.getEntriesByType && performance.getEntriesByType('navigation')[0]) || null;
      const isFirstNav = nav ? nav.type === 'navigate' : true;
      const alreadyShown = sessionStorage.getItem('splashShownV2') === '1';
      window.__SHOW_SPLASH__ = isFirstNav && !alreadyShown;

      // Si no se va a mostrar, forzamos estilos antes del primer pintado.
      if(!window.__SHOW_SPLASH__){
        const s = document.createElement('style');
        s.innerHTML = '#splash{display:none!important;opacity:0!important} .wrapper{opacity:1!important}';
        document.head.appendChild(s);
      }
    })();
  </script>
</head>
<body>
  <!-- SPLASH -->
  <div id="splash" aria-live="polite">
    <img src="icons/icon-192.png" alt="Logo Taller">
    <div class="brand">El Señor de los Scanner</div>
    <div class="tagline">Cargando panel principal…</div>
    <div class="bar" aria-hidden="true"></div>
  </div>

  <div class="topbar">WWW.ELSEÑORDELOSESCANER.CL</div>

  <div class="wrapper">
    <div class="frame">
      <div class="header">
        <h1>Panel Principal</h1>
      </div>

      <div class="grid" role="list">
        <!-- Gestión de Vehículos -->
        <article class="card" role="listitem" tabindex="0">
          <div class="card-inner">
            <div class="card-front">
              <div class="icon">🚗</div>
              <div class="content">
                <h2 class="title">Gestión de Vehículos</h2>
                <p class="desc">Añadir, buscar y actualizar el estado de los autos del taller.</p>
              </div>
              <div class="actions">
                <a class="btn" href="gestion_autos.html">Abrir</a>
              </div>
            </div>
            <div class="card-back">
              <h3 class="title">Estadísticas</h3>
              <div class="stats">
                <div class="stat">
                  <div class="stat-value">12</div>
                  <div class="stat-label">En Taller</div>
                </div>
                <div class="stat">
                  <div class="stat-value">3</div>
                  <div class="stat-label">En Espera</div>
                </div>
              </div>
              <p class="back-desc">Última actualización: hoy 14:30</p>
              <div class="flip-hint">Click para voltear</div>
            </div>
          </div>
        </article>

        <!-- Computadoras -->
        <article class="card" role="listitem" tabindex="0">
          <div class="card-inner">
            <div class="card-front">
              <div class="icon">💻</div>
              <div class="content">
                <h2 class="title">Computadoras</h2>
                <p class="desc">Gestión de DPF OFF y registro/consulta de ECUs/BCMs.</p>
              </div>
              <div class="actions">
                <a class="btn" href="dpf_off.html">Abrir</a>
              </div>
            </div>
            <div class="card-back">
              <h3 class="title">Actividad Reciente</h3>
              <div class="stats">
                <div class="stat">
                  <div class="stat-value">7</div>
                  <div class="stat-label">DPF OFF</div>
                </div>
                <div class="stat">
                  <div class="stat-value">24</div>
                  <div class="stat-label">ECUs</div>
                </div>
              </div>
              <p class="back-desc">5 procesos activos actualmente</p>
              <div class="flip-hint">Click para voltear</div>
            </div>
          </div>
        </article>

        <!-- Informes -->
        <article class="card" role="listitem" tabindex="0">
          <div class="card-inner">
            <div class="card-front">
              <div class="icon">📄</div>
              <div class="content">
                <h2 class="title">Informes de Diagnóstico</h2>
                <p class="desc">Crear informes. Se abre en una pestaña nueva.</p>
              </div>
              <div class="actions">
                <a class="btn" href="https://taller-todo.vercel.app/informes.html" target="_blank">Abrir</a>
              </div>
            </div>
            <div class="card-back">
              <h3 class="title">Informes del Mes</h3>
              <div class="stats">
                <div class="stat">
                  <div class="stat-value">42</div>
                  <div class="stat-label">Generados</div>
                </div>
                <div class="stat">
                  <div class="stat-value">5</div>
                  <div class="stat-label">Pendientes</div>
                </div>
              </div>
              <p class="back-desc">Tiempo promedio: 15 min por informe</p>
              <div class="flip-hint">Click para voltear</div>
            </div>
          </div>
        </article>

        <!-- Orden de llegada -->
        <article class="card" role="listitem" tabindex="0">
          <div class="card-inner">
            <div class="card-front">
              <div class="icon">🕰️</div>
              <div class="content">
                <h2 class="title">Orden de llegada</h2>
                <p class="desc">Gestión de turnos de clientes por orden de ingreso.</p>
              </div>
              <div class="actions">
                <a class="btn" href="clientes_turno.html">Abrir</a>
              </div>
            </div>
            <div class="card-back">
              <h3 class="title">Cola Actual</h3>
              <div class="stats">
                <div class="stat">
                  <div class="stat-value">8</div>
                  <div class="stat-label">En Espera</div>
                </div>
                <div class="stat">
                  <div class="stat-value">2</div>
                  <div class="stat-label">Atendidos</div>
                </div>
              </div>
              <p class="back-desc">Tiempo estimado: 25 min</p>
              <div class="flip-hint">Click para voltear</div>
            </div>
          </div>
        </article>

        <!-- Panel clientes -->
        <article class="card" role="listitem" tabindex="0">
          <div class="card-inner">
            <div class="card-front">
              <div class="icon">🧾</div>
              <div class="content">
                <h2 class="title">Panel clientes (Orden)</h2>
                <p class="desc">Vista pública para que el cliente vea su turno.</p>
              </div>
              <div class="actions">
                <a class="btn" href="panel_clientes.html">Abrir</a>
              </div>
            </div>
            <div class="card-back">
              <h3 class="title">Vista Cliente</h3>
              <div class="stats">
                <div class="stat">
                  <div class="stat-value">15</div>
                  <div class="stat-label">Visitas Hoy</div>
                </div>
                <div class="stat">
                  <div class="stat-value">89%</div>
                  <div class="stat-label">Satisfacción</div>
                </div>
              </div>
              <p class="back-desc">Panel activo las 24 horas</p>
              <div class="flip-hint">Click para voltear</div>
            </div>
          </div>
        </article>

        <!-- Tarjeta virtual -->
        <article class="card" role="listitem" tabindex="0">
          <div class="card-inner">
            <div class="card-front">
              <div class="icon">🤳</div>
              <div class="content">
                <h2 class="title">Tarjeta Virtual</h2>
                <p class="desc">Mostrar QR o compartir link de contacto.</p>
              </div>
              <div class="actions">
                <a class="btn" href="tarjeta-virtual.html">Abrir</a>
              </div>
            </div>
            <div class="card-back">
              <h3 class="title">Estadísticas QR</h3>
              <div class="stats">
                <div class="stat">
                  <div class="stat-value">127</div>
                  <div class="stat-label">Escaneos</div>
                </div>
                <div class="stat">
                  <div class="stat-value">23</div>
                  <div class="stat-label">Compartidos</div>
                </div>
              </div>
              <p class="back-desc">+15% este mes</p>
              <div class="flip-hint">Click para voltear</div>
            </div>
          </div>
        </article>

        <!-- Buscador -->
        <article class="card" role="listitem" tabindex="0">
          <div class="card-inner">
            <div class="card-front">
              <div class="icon">🏎️</div>
              <div class="content">
                <h2 class="title">Buscador de Códigos</h2>
                <p class="desc">Consulta rápida de DTC y descripciones.</p>
              </div>
              <div class="actions">
                <a class="btn" href="buscador_averias.html" target="_blank">Abrir</a>
              </div>
            </div>
            <div class="card-back">
              <h3 class="title">Base de Datos</h3>
              <div class="stats">
                <div class="stat">
                  <div class="stat-value">2.4K</div>
                  <div class="stat-label">Códigos</div>
                </div>
                <div class="stat">
                  <div class="stat-value">78</div>
                  <div class="stat-label">Búsq. Hoy</div>
                </div>
              </div>
              <p class="back-desc">Actualizado: Abril 2025</p>
              <div class="flip-hint">Click para voltear</div>
            </div>
          </div>
        </article>

        <!-- Patentes Chile -->
        <article class="card" role="listitem" tabindex="0">
          <div class="card-inner">
            <div class="card-front">
              <div class="icon">🔢</div>
              <div class="content">
                <h2 class="title">Patentes Chile</h2>
                <p class="desc">Consulta externa de información por patente.</p>
              </div>
              <div class="actions">
                <a class="btn" href="https://www.patentechile.com/" target="_blank" rel="noopener">Abrir</a>
              </div>
            </div>
            <div class="card-back">
              <h3 class="title">Consultas</h3>
              <div class="stats">
                <div class="stat">
                  <div class="stat-value">34</div>
                  <div class="stat-label">Hoy</div>
                </div>
                <div class="stat">
                  <div class="stat-value">1.2K</div>
                  <div class="stat-label">Este Mes</div>
                </div>
              </div>
              <p class="back-desc">Integración directa</p>
              <div class="flip-hint">Click para voltear</div>
            </div>
          </div>
        </article>
      </div>
    </div>
    <div class="footer">© 2025 <strong>Benjamin González</strong>. Todos los derechos reservados.</div>
  </div>

  <script>
    // ⏱️ Tiempo mínimo del splash (más corto)
    const MIN_SPLASH_MS = 900; // 0.9s

    // Mostrar u ocultar según decisión temprana
    (async function(){
      const splash  = document.getElementById('splash');
      const wrapper = document.querySelector('.wrapper');

      // Si no debe mostrarse (segunda visita en la pestaña, etc.)
      if(!window.__SHOW_SPLASH__){
        wrapper.style.opacity = '1';
        splash.style.display = 'none';
        return;
      }

      // Esperar al logo para evitar parpadeos
      const waitForLogo = () => new Promise(res => {
        const img = splash.querySelector('img');
        if (!img || img.complete) return res();
        img.addEventListener('load', res, { once:true });
        img.addEventListener('error', res, { once:true });
      });

      const start = performance.now();
      await waitForLogo();
      const elapsed = performance.now() - start;

      setTimeout(() => {
        splash.style.opacity = '0';
        wrapper.style.opacity = '1';
        setTimeout(() => splash.remove(), 400); // coincide con transition .4s
        sessionStorage.setItem('splashShownV2', '1');
      }, Math.max(0, MIN_SPLASH_MS - elapsed));
    })();

    // Efecto flip para las tarjetas
    document.addEventListener('DOMContentLoaded', function() {
      const cards = document.querySelectorAll('.card');
      
      cards.forEach(card => {
        card.addEventListener('click', function(e) {
          // Evitar el flip si se hace click en un botón
          if (e.target.closest('.btn')) {
            return;
          }
          this.classList.toggle('flipped');
        });
        
        // También permitir flip con la tecla Enter
        card.addEventListener('keydown', function(e) {
          if (e.key === 'Enter' && !e.target.closest('.btn')) {
            this.classList.toggle('flipped');
          }
        });
      });
    });
  </script>
</body>
</html>